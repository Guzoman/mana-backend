# REGLAS DE ARCHIVOS .ENV - BACKEND MANA PROJECT

## ⚠️ IMPORTANTE: SOLO UN ARCHIVO .ENV POR SERVICIO

### Arquitectura correcta:
```
mana-backend/
├── .env                # ← USAR ESTE para configuración principal
└── auth-bff/
    └── .env            # ← USAR ESTE para Auth-BFF

# ❌ ELIMINAR:
# - .env.dev           (conflictivo)
# - .env.local         (conflictivo)
# - .env.backup        (innecesario)
# - .env.mock          (innecesario)
```

### Configuración actual correcta:

**Backend principal (.env):**
```bash
# Database credentials
DATABASE_PASSWORD=CambiaEstaClaveFuerte

# JWT & Security
JWT_SECRET=8PUYoWs1utporyzHFQxQRRQA+t3afA3dtkVbgOOwhHE=
JWT_TTL=3600

# Flowise & ZEP tokens
FLOWISE_SERVICE_TOKEN=7c0515b8acc7ba158e6e816d95a78ea4a3a5a71bd96a0600b447c2b5e4b83ab3
ZEP_API_KEY=z_1dWlkIjoiNWVhZDA3MjEtYjAxMS00MTJmLWJiOGEtYTE5YjM0ZDFhYmYyIn0.1wrMLvx5EHc6SjxpeNAV5tK4i-uNfZ8kEnVsLVQ6ZwsRRGU2vbsQ-VLA3TlKnAK7fJzo5bdj6wKNo6Lt4yk3KA
ZEP_API_URL=https://api.getzep.com

# Email
POSTMARK_API_KEY=5be8477d-78ed-4ca4-8894-c4bcc92f084f
FROM_EMAIL=noreply@manaproject.app

# Domain
DOMAIN_NAME=manaproject.app
```

**Auth-BFF (auth-bff/.env):**
```bash
PORT=3000
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=mana
DATABASE_PASSWORD=mana_local_dev
DATABASE_NAME=mana
DATABASE_SSL=false
JWT_SECRET=dev-secret-local-testing
JWT_TTL=3600
RP_ID=localhost
ORIGIN=https://localhost:5174
CORS_ORIGINS=https://localhost:5173,https://localhost:5174,https://localhost:5175,https://localhost:5176,https://localhost:5177,https://localhost:5178,https://localhost:5179,https://manaproject.app
FLOWISE_URL=http://localhost:3001
FLOWISE_FLOW_ID=cdcb7665-5e80-4283-b84f-4d7a080c6044
FLOWISE_API_KEY=W75HtW9sxtghpgF48lZeieOdP-ycn3a729MALtBAZr0
MOCK_MODE=false
```

### Notas importantes:
1. **Docker Compose** usa variables de entorno de los archivos .env
2. **localhost:3000** en docker-compose.yml es para comunicación interna entre contenedores Docker
3. **localhost:3001** es para conexión directa a Flowise fuera de Docker
4. **localhost:8080** es el puerto del nginx proxy para el frontend

### Reglas estrictas:
1. Mantener solo 1 archivo .env por servicio
2. No crear archivos .env.dev, .env.local, etc.
3. Si se necesita cambiar configuración, modificar los archivos existentes
4. Documentar cualquier cambio en este archivo

---
**Fecha:** 2025-09-13  
**Autor:** Claude Code  
**Estado:** Documentación activa para prevenir futuros problemas